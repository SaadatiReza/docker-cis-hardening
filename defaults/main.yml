---
# Docker configuration parameters
docker_cis_config:
  icc: false
  userns_remap: ""
  log_driver: "json-file"
  log_opts:
    max-size: "10m"
    max-file: "3"
  disable_legacy_registry: true
  live_restore: true
  userland_proxy: false
  no_new_privileges: true
  default_ulimits:
    - "nofile=1024:1024"

# Auditd configuration
auditd_rules:
  - "-w /usr/lib/systemd/system/docker.service -p rwxa -k docker"
  - "-w /etc/docker -p rwxa -k docker"
  - "-w /etc/default/docker -p rwxa -k docker"
  - "-w /etc/docker/daemon.json -p rwxa -k docker"
  - "-w /usr/bin/docker -p rwxa -k docker"
  - "-w /usr/bin/dockerd -p rwxa -k docker"
  - "-w /var/run/docker.sock -p rwxa -k docker"

# Files to check permissions
file_permissions:
  - path: /usr/bin/docker
    owner: root
    group: root
    mode: "0755"
  - path: /var/run/docker.sock
    owner: root
    group: docker
    mode: "0660"

# Swarm configuration
swarm_config:
  auto_lock: true
  cert_expiry: "2160h"
  dispatcher_heartbeat: "5s"
  node_cert_expiry: "2160h"
  external_ca: false